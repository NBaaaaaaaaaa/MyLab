Цель - изменить значение `int changeme;`

Уязвимое место 
```
void bounce(char *str) {
  printf(str);
}
```

Значит необходимо передать программе строку так, чтобы %n записал значение по адресу `changeme`

Ищем смещение `buf` в стеке перед вызовом `printf(str);`\
![alt text](../images/format-two/1.png)

Т.к. это 64 битная программа, то сначала надо пропустить регистры rsi, rdx, rcx, r8, r9, а уже после 6 qword в стеке (rdi хранит адрес нашей строки (аргумент функции printf))

Проверяем сказанное\
![alt text](../images/format-two/2.png)

Следовательно необходимо добавить в строку адрес переменной `changeme` + местоположение в стеке должно быть выравнено по 8 байтовой границе.

Адрес \
![alt text](../images/format-two/3.png)

Формируем строку\
![alt text](../images/format-two/4.png)

Теперь осталось пропустить 6 qword в стеке, чтобы добраться до переданного адреса переменной `changeme`\
![alt text](../images/format-two/5.png)

Меняем %p на %n и победа\
![alt text](../images/format-two/6.png)